{
  "policies": [
    {
      "name": "drop-echo-logs",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [
        { "match_type": "log_attribute", "key": "ddsource", "regex": "nginx" }
      ],
      "action": "drop"
    },
    {
      "name": "drop-debug-logs",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [
        { "match_type": "log_body", "regex": "debug" },
        { "match_type": "log_body", "regex": "trace" }
      ],
      "action": "drop"
    },
    {
      "name": "drop-no-such-file-or-directory-logs",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [
        { "match_type": "log_body", "regex": "^.*no such file or directory$" }
      ],
      "action": "drop"
    },
    {
      "name": "drop-debug-level",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [{ "match_type": "log_severity_text", "regex": "DEBUG" }],
      "action": "drop"
    },
    {
      "name": "keep-error-logs",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [
        { "match_type": "log_severity_text", "regex": "error" },
        { "match_type": "log_severity_text", "regex": "critical" },
        { "match_type": "log_severity_text", "regex": "fatal" }
      ],
      "action": "keep"
    }
  ]
}
