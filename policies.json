{
  "policies": [
    {
      "name": "drop-echo-logs",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [{ "path": "$.ddsource", "regex": "nginx" }],
      "action": "drop"
    },
    {
      "name": "drop-debug-logs",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [
        { "path": "$.body", "regex": "debug" },
        { "path": "$.body", "regex": "trace" }
      ],
      "action": "drop"
    },
    {
      "name": "drop-debug-level",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [{ "path": "$.level", "regex": "DEBUG" }],
      "action": "drop"
    },
    {
      "name": "keep-error-logs",
      "policy_type": "filter",
      "telemetry_types": ["logs"],
      "matchers": [
        { "path": "$.severity_text", "regex": "error" },
        { "path": "$.severity_text", "regex": "critical" },
        { "path": "$.severity_text", "regex": "fatal" }
      ],
      "action": "keep"
    }
  ]
}
