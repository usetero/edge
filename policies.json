{
  "policies": [
    {
      "id": "drop-echo-logs",
      "name": "drop-echo-logs",
      "log": {
        "match": [{ "log_attribute": "ddsource", "regex": "nginx" }],
        "keep": "none"
      }
    },
    {
      "id": "drop-debug-logs",
      "name": "drop-debug-logs",
      "log": {
        "match": [
          { "log_field": "body", "regex": "debug" },
          { "log_field": "body", "regex": "trace" }
        ],
        "keep": "none"
      }
    },
    {
      "id": "drop-no-such-file-or-directory-logs",
      "name": "drop-no-such-file-or-directory-logs",
      "log": {
        "match": [
          { "log_field": "body", "regex": "no such file or directory" }
        ],
        "keep": "none"
      }
    },
    {
      "id": "drop-debug-level",
      "name": "drop-debug-level",
      "log": {
        "match": [{ "log_field": "severity_text", "regex": "DEBUG" }],
        "keep": "none"
      }
    },
    {
      "id": "drop-edge-logs",
      "name": "drop-edge-logs",
      "log": {
        "match": [
          { "resource_attribute": "service.name", "regex": "^.*edge$" }
        ],
        "keep": "none"
      }
    },
    {
      "id": "keep-error-logs",
      "name": "keep-error-logs",
      "log": {
        "match": [
          { "log_field": "severity_text", "regex": "error" },
          { "log_field": "severity_text", "regex": "critical" },
          { "log_field": "severity_text", "regex": "fatal" }
        ],
        "keep": "all"
      }
    },
    {
      "id": "drop-system-load-metric",
      "name": "drop-system-load-metric",
      "metric": {
        "match": [{ "metric_field": "name", "regex": "^.*system.load.*$" }],
        "keep": false
      }
    }
  ]
}
