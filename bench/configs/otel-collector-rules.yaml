receivers:
  # Datadog receiver - receives Datadog format logs
  datadog:
    endpoint: 127.0.0.1:8080
    read_timeout: 60s

  # OTLP receiver - receives OTLP format logs
  otlp:
    protocols:
      http:
        endpoint: 127.0.0.1:8081

processors:
  # Minimal batching for benchmarks - send data quickly
  batch:
    send_batch_size: 10000

  # Filter processor - equivalent to policies.json rules
  # Note: filter processor drops matching logs (no "keep" action, only exclude)
  # The "keep-errors" policy can't be directly translated as filter only drops
  filter:
    error_mode: ignore
    logs:
      log_record:
        # drop-debug-logs: Drop debug level logs
        - 'severity_text == "DEBUG" or severity_text == "debug"'
        # drop-health-checks: Drop health check logs
        - 'IsMatch(body, ".*/health.*")'
        - 'IsMatch(body, ".*/ready.*")'
        - 'IsMatch(body, ".*/live.*")'
        # drop-database-queries: Drop database query logs
        - 'IsMatch(body, ".*Database query executed.*")'
        # drop-first-entry: Drop first log entry in 1MB payloads
        - 'IsMatch(body, ".*Log entry 0:.*")'

exporters:
  # Debug exporter for logging
  debug:
    verbosity: basic

  # Datadog exporter - sends to echo server
  datadog:
    host_metadata:
      enabled: false
    api:
      key: "xxxxxxxxxxxxx"
      site: "us5.datadoghq.com"
    logs:
      endpoint: "http://127.0.0.1:9999"

  # OTLP HTTP exporter - sends to echo server
  otlphttp:
    endpoint: http://127.0.0.1:9999
    compression: none

service:
  telemetry:
    logs:
      level: info
  pipelines:
    logs/datadog:
      receivers: [datadog]
      processors: [filter, batch]
      exporters: [datadog, debug]
    logs/otlp:
      receivers: [otlp]
      processors: [filter, batch]
      exporters: [otlphttp, debug]
